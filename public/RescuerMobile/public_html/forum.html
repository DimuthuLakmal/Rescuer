<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8">
        <title>Forum</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

        <link rel="stylesheet" type="text/css" href="css/normalize.css">
        <link rel="stylesheet" type="text/css" href="css/framework.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="css/washington.css">
        <link rel="stylesheet" type="text/css" href="css/modal.css">
        <link rel="stylesheet" type="text/css" href="css/dropdown.css">
        <link rel="stylesheet" type="text/css" href="css/noJS.css">
        <script src="js/modernizr.custom.79639.js"></script>
        <script src="js/webfont.js"></script>
        <script>
            WebFont.load({
                google: {
                    families: ["Montserrat:400,700"]
                }
            });
        </script>

        <script type="text/javascript" src="js/modernizr.js"></script>
        <link rel="shortcut icon" type="image/x-icon" href="images/logoStandford32.ico">
        <link rel="apple-touch-icon" href="images/logoStandford32.ico">

        <link href="css/ionicons.min.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <section class="w-section mobile-wrapper"> <div class="page-content" id="main-stack" data-scroll="0">
                <div class="w-nav navbar" data-collapse="all" data-animation="over-left" data-duration="400" data-contain="1" data-easing="ease-out-quint" data-no-scroll="1">
                    <div class="w-container">
                        <nav class="w-nav-menu nav-menu" role="navigation">
                            <div class="nav-menu-header">
                                <div class="logo">Rescuer</div>
                            </div>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="index2.html" data-load="1">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-home-outline"></div>
                                </div>
                                <div class="nav-menu-titles">Home</div>
                            </a>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="search_by_route.html" data-load="1">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-search"></div>
                                </div>
                                <div class="nav-menu-titles">View Warnings</div>
                            </a>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="search_by_destination.html" data-load="1">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-search"></div>
                                </div>
                                <div class="nav-menu-titles">FAQ</div>
                            </a>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="traffic.html">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-navigate"></div>
                                </div>
                                <div class="nav-menu-titles">Make A Plan</div>
                            </a>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="traffic.html">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-navigate"></div>
                                </div>
                                <div class="nav-menu-titles">Emergency Plan</div>
                            </a>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="index.html" data-load="1">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-cloud-upload-outline"></div>
                                </div>
                                <div class="nav-menu-titles">Log out</div>
                            </a>
                            <div class="separator-bottom"></div>
                            <div class="separator-bottom"></div>
                            <div class="separator-bottom"></div>
                        </nav>
                        <div class="wrapper-mask" data-ix="menu-mask"></div>
                        <div class="navbar-title">Forum</div>
                        <div class="w-nav-button navbar-button left" id="menu-button" data-ix="hide-navbar-icons">
                            <div class="navbar-button-icon home-icon">
                                <div class="bar-home-icon"></div>
                                <div class="bar-home-icon"></div>
                                <div class="bar-home-icon"></div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="body container">
                    <div class="w-form">
                        <form>
                            <div class="form-group">
                                <textarea class="form-control" rows="3" placeholder="Enter your question" id='questionarea'></textarea>
                            </div>
                            <div class="form-group">
                                <div id="dd" class="wrapper-dropdown-5" tabindex="1"><span id="selected_type">Select Type</span>
                                    <ul class="dropdown">
                                        <li><a href="#" id="select_flood">Flood</a></li>
                                        <li><a href="#" id="select_landslide">Land Slide</a></li>
                                        <li><a href="#" id="select_wildfire">Wild Fire</a></li>
                                    </ul>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-success btn-sm" style="float: right" id='postbtn'>&nbsp;&nbsp;&nbsp;Post&nbsp;&nbsp;&nbsp;</button>
                        </form>
                    </div>

                </div>
                <br>
                <div class="container" id='askedQ'>
                </div>
            </div>
            <div class="modal"></div>
        </section>
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script>
            $(document).ready(function () {
                jQuery.ajax({
                    type: "GET",
                    url: 'http://localhost/mobileforum',
                    success: function (obj, textstatus) {
                        if (!('error' in obj)) {
                            $.each(obj, function (index, element) {
                                alert(Object.keys(element));
                                $('#askedQ').append('<div class=\"row\" style=\'background-color: #f6f6f6;\'>' +
                                        '<div class=\"container\"' +
                                        '<br>' +
                                        '<div class=\"container\"><br>' +
                                        '<p><b>' + element.description + '</b></p>' +
                                        '</div>' +
                                        '<table class=\'table table-striped\' id=\'' + element.id + '\'>' +
                                        '</table>' +
                                        '<div class="container">' +
                                        '<form>' +
                                        '<input type=\"hidden\" value=\"' + element.id + '\">' +
                                        '<input type=\"text\" class=\"form-control post_comment\" placeholder=\"Enter your comment\"><br>' +
                                        '<button class=\"btn btn-sm btn-info comment_button\">Comment</button>' +
                                        '</form>' +
                                        '</div>' +
                                        '<br>' +
                                        '</div>' +
                                        '</div><br>');
                            });
                        }
                        else {
                            console.log(obj.error);
                        }
                    }
                });

            });
        </script>
        <script>
            $('#postbtn').click(function (e) {
                e.preventDefault();
                var description = $('#questionarea').val();
                var type = $('#selected_type').text();

                jQuery.ajax({
                    type: "GET",
                    dataType: 'jsonp',
                    url: 'http://localhost/mobileforum/description/' + description + '/user_id/1/type/' + type,
                    success: function (obj, textstatus) {
                        if (obj == 'Success') {
                            alert('Successfully submited');
                            $('#askedQ').append('<div class=\"row\" style=\'background-color: #f6f6f6;\'>' +
                                    '<div class=\"container\"' +
                                    '<br>' +
                                    '<div class=\"container\"><br>' +
                                    '<p><b>' + description + '</b></p>' +
                                    '</div>' +
                                    '<table class=\'table table-striped\' id=\'' + 1 + '\'>' +
                                    '</table>' +
                                    '<div class="container">' +
                                    '<form>' +
                                    '<input type=\"hidden\" value=\"' + 1 + '\">' +
                                    '<input type=\"text\" class=\"form-control post_comment\" placeholder=\"Enter your comment\"><br>' +
                                    '<button class=\"btn btn-sm btn-info comment_button\">Comment</button>' +
                                    '</form>' +
                                    '</div>' +
                                    '<br>' +
                                    '</div>' +
                                    '</div><br>');
                        }
                    }
                });

            });
        </script>
        <script>
            $('#askedQ').on('click', '.comment_button', function (e) {
                e.preventDefault();
                var comment = $(this).prev().prev().val();
                var id = $(this).prev().prev().prev().val();
                jQuery.ajax({
                    type: "GET",
                    url: 'http://localhost/mobileforum/description/' + comment + '/user_id/1/q_id/' + id,
                    dataType: 'jsonp',
                    success: function (obj, textstatus) {
                        $('#' + id).append('<tr>' +
                                '<td>' +
                                '<div class=\"row\">' +
                                '<p><b>Dimuthu</b></p>' +
                                '<p>' + comment + '</p>' +
                                '</div>' +
                                '</td>' +
                                '</tr>'
                                );
                    }
                });

            });
        </script>
        <script>
            $body = $("body");

            $(document).on({
                ajaxStart: function () {
                    $body.addClass("loading");
                },
                ajaxStop: function () {
                    $body.removeClass("loading");
                }
            });
        </script>

        <script>
            $('#select_flood').click(function () {
                $('#selected_type').text("Flood");
            });
            $('#select_wildfire').click(function () {
                $('#selected_type').text("Wild Fire");
            });
            $('#select_landslide').click(function () {
                $('#selected_type').text("Land Slide");
            });
        </script>

        <script type="text/javascript">

            function DropDown(el) {
                this.dd = el;
                this.initEvents();
            }
            DropDown.prototype = {
                initEvents: function () {
                    var obj = this;

                    obj.dd.on('click', function (event) {
                        $(this).toggleClass('active');
                        event.stopPropagation();
                    });
                }
            }

            $(function () {

                var dd = new DropDown($('#dd'));

                $(document).click(function () {
                    // all dropdowns
                    $('.wrapper-dropdown-5').removeClass('active');
                });

            });

        </script>

        <!--[if lte IE 9]><script src="js/placeholders.min.js"></script><![endif]-->
    </body>
</html>