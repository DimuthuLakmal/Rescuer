<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8">
        <title>Emergency Numbers</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="css/normalize.css">
        <link rel="stylesheet" type="text/css" href="css/framework.css">
        <link rel="stylesheet" type="text/css" href="css/washington.css">
        <link rel="stylesheet" type="text/css" href="css/modal.css">
        <link rel="stylesheet" type="text/css" href="css/dropdown.css">
        <link rel="stylesheet" type="text/css" href="css/noJS.css">
        <script src="js/modernizr.custom.79639.js"></script>
        <script src="js/webfont.js"></script>
        <script>
            WebFont.load({
                google: {
                    families: ["Montserrat:400,700"]
                }
            });
        </script>

        <script type="text/javascript" src="js/modernizr.js"></script>
        <link rel="shortcut icon" type="image/x-icon" href="images/logoStandford32.ico">
        <link rel="apple-touch-icon" href="images/logoStandford32.ico">

        <link href="css/ionicons.min.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <section class="w-section mobile-wrapper"> 
            <div class="page-content" id="main-stack" data-scroll="0">
                <div class="w-nav navbar" data-collapse="all" data-animation="over-left" data-duration="400" data-contain="1" data-easing="ease-out-quint" data-no-scroll="1">
                    <div class="w-container">
                        <nav class="w-nav-menu nav-menu" role="navigation">
                            <div class="nav-menu-header">
                                <div class="logo">Rescuer</div>
                            </div>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="index2.html" data-load="1">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-home-outline"></div>
                                </div>
                                <div class="nav-menu-titles">Home</div>
                            </a>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="search_by_route.html" data-load="1">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-search"></div>
                                </div>
                                <div class="nav-menu-titles">View Warnings</div>
                            </a>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="search_by_destination.html" data-load="1">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-search"></div>
                                </div>
                                <div class="nav-menu-titles">FAQ</div>
                            </a>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="traffic.html">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-navigate"></div>
                                </div>
                                <div class="nav-menu-titles">Make A Plan</div>
                            </a>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="traffic.html">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-navigate"></div>
                                </div>
                                <div class="nav-menu-titles">Emergency Plan</div>
                            </a>
                            <a class="w-clearfix w-inline-block nav-menu-link" href="index.html" data-load="1">
                                <div class="icon-list-menu">
                                    <div class="icon ion-ios-cloud-upload-outline"></div>
                                </div>
                                <div class="nav-menu-titles">Log out</div>
                            </a>
                            <div class="separator-bottom"></div>
                            <div class="separator-bottom"></div>
                            <div class="separator-bottom"></div>
                        </nav>
                        <div class="wrapper-mask" data-ix="menu-mask"></div>
                        <div class="navbar-title">Emergency Numbers</div>
                        <div class="w-nav-button navbar-button left" id="menu-button" data-ix="hide-navbar-icons">
                            <div class="navbar-button-icon home-icon">
                                <div class="bar-home-icon"></div>
                                <div class="bar-home-icon"></div>
                                <div class="bar-home-icon"></div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="body padding">
                    <br>
                    <ul class="nav nav-tabs">
                        <li class="active"><a data-toggle="tab" href="#home">Rescue Centers</a></li>
                        <li><a data-toggle="tab" href="#menu1">Send SMS</a></li>
                    </ul>

                    <div class="tab-content">
                        <div id="home" class="tab-pane fade in active">
                            <h5>Call Rescue Centers</h5><br>
                            <div class="w-form">
                                <form id="email-form" name="email-form" data-name="Email Form" action="#">

                                    <div>
                                        <label class="label-form" for="full-name-field">Town</label>
                                        <input class="w-input input-form" id="town" type="text" name="town" required="required">
                                    </div>

                                    <div class="form-group">
                                        <div id="dd" class="wrapper-dropdown-5" tabindex="1"><span id="selected_type">Select Type</span>
                                            <ul class="dropdown">
                                                <li><a href="#" id="select_flood">Flood</a></li>
                                                <li><a href="#" id="select_landslide">Land Slide</a></li>
                                                <li><a href="#" id="select_wildfire">Wild Fire</a></li>
                                                <li><a href="#" id="select_police">Police</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div>
                                        <div>
                                            <input class="w-button action-button" type="submit" value="Call" id="submitbtn">
                                            <div class="separator-fields"></div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="text-new no-borders call_centers_div" id="results_centers">
                            </div>
                        </div>
                        <div id="menu1" class="tab-pane fade">
                            <h5>Send Emergency SMS</h5>
                            <div class="text-new no-borders emergency_numbers_div">
                                <div class="w-row">
                                    <div class="w-col w-col-4 w-col-small-4 w-col-tiny-4">
                                        <h6 class="emergency_name">Dimuthu</h6>
                                    </div>
                                    <div class="w-col w-col-4 w-col-small-4 w-col-tiny-4">
                                        <h6 class="emergency_tel">0712924287</h6>
                                    </div>
                                    <div class="w-col w-col-4 w-col-small-4 w-col-tiny-4">
                                        <div class="checkbox">
                                            <label><input type="checkbox" value="" class="checkboxfield"></label>
                                        </div>
                                    </div>

                                </div> 
                                <div class="w-row">
                                    <div class="w-col w-col-4 w-col-small-4 w-col-tiny-4 emergency_name_div">
                                        <h6 class="emergency_name">Dimuthu</h6>
                                    </div>
                                    <div class="w-col w-col-4 w-col-small-4 w-col-tiny-4">
                                        <h6 class="emergency_tel">0712924287</h6>
                                    </div>
                                    <div class="w-col w-col-4 w-col-small-4 w-col-tiny-4">
                                        <div class="checkbox">
                                            <label><input type="checkbox" value="" class="checkboxfield"></label>
                                        </div>
                                    </div>
                                    <div align="center">
                                        <input class="btn btn-primary btn-sm" type="submit" value="Check All" id="checkbtn">
                                    </div>

                                </div> 
                                <div class="separator-button"></div>
                                <div>
                                    <input class="w-button action-button" type="submit" value="Send Emergency SMS" id="sendemergencysmsbtn">
                                    <div class="separator-fields"></div>
                                </div>
                                <div class="w-form" id="sendcustomsmsform" style="display: none">
                                    <form id="email-form" name="email-form" data-name="Email Form" action="#">

                                        <div>
                                            <label class="label-form" for="full-name-field">Message</label>
                                            <textarea class="form-control" rows="5" placeholder="Enter your message" id='message' maxlength="160"></textarea>
                                        </div>
                                    </form>
                                </div>
                                <div>
                                    <input class="w-button action-button" type="submit" value="Send Custom SMS" id="sendcustombtn">
                                    <div class="separator-fields"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal"></div>
        </section>
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="js/framework.js"></script>
        <script>
            $body = $("body");

            $(document).on({
                ajaxStart: function () {
                    $body.addClass("loading");
                },
                ajaxStop: function () {
                    $body.removeClass("loading");
                }
            });
        </script>
        <script>
            $('#select_flood').click(function () {
                $('#selected_type').text("Flood");
            });
            $('#select_wildfire').click(function () {
                $('#selected_type').text("Wild Fire");
            });
            $('#select_landslide').click(function () {
                $('#selected_type').text("Land Slide");
            });
            $('#select_police').click(function () {
                $('#selected_type').text("Police");
            });
        </script>

        <script type="text/javascript">

            function DropDown(el) {
                this.dd = el;
                this.initEvents();
            }
            DropDown.prototype = {
                initEvents: function () {
                    var obj = this;

                    obj.dd.on('click', function (event) {
                        $(this).toggleClass('active');
                        event.stopPropagation();
                    });
                }
            }

            $(function () {

                var dd = new DropDown($('#dd'));

                $(document).click(function () {
                    // all dropdowns
                    $('.wrapper-dropdown-5').removeClass('active');
                });

            });

        </script>

        <script>

            $('#submitbtn').click(function (e) {

                e.preventDefault();

                var town = $('#town').val();
                var type = $('#selected_type').text();
                jQuery.ajax({
                    type: "GET",
                    url: 'http://localhost/mobile_rescue_center/town/' + town + '/type/' + type,
                    dataType: 'jsonp',
                    success: function (obj, textstatus) {
                        if (!('error' in obj)) {
                            $.each(obj, function (index, element) {
                                $('#results_centers').append('<div class="w-row">' +
                                        '<div class="w-col w-col-4 w-col-small-4 w-col-tiny-4">' +
                                        '<h6>' + element.name + '</h6>' +
                                        '</div>' +
                                        '<div class="w-col w-col-4 w-col-small-4 w-col-tiny-4">' +
                                        '<h6 class="callcenter">' + element.telephone + '</h6>' +
                                        '</div>' +
                                        '<div class="w-col w-col-4 w-col-small-4 w-col-tiny-4">' +
                                        '<p class="description-new"><button class="btn btn-sm btn-primary callnumber">Call</button></p>' +
                                        '</div>' +
                                        '</div>')
                            });
                        }
                        else {
                            console.log(obj.error);
                        }
                    }
                });


            });


        </script>
        <script>
            $('#checkbtn').click(function () {
                $('.checkboxfield').prop('checked', true);
            });
        </script>

        <script>
            $('#sendcustombtn').click(function () {
                if ($(this).val() == "Send Custom SMS") {
                    $('#sendcustomsmsform').slideDown("fast");
                    $(this).val("Send It!");
                } else {
                    $(".emergency_numbers_div").find(".checkboxfield").each(function () {
                        if ($(this).prop('checked') == true) {
                            alert($(this).parent().parent().parent().parent().children().find(".emergency_tel").text());
                        }
                    });
                }
            });
        </script>

        <script>
            $('#sendemergencysmsbtn').click(function () {
                $(".emergency_numbers_div").find(".checkboxfield").each(function () {
                    if ($(this).prop('checked') == true) {
                        alert($(this).parent().parent().parent().parent().children().find(".emergency_tel").text());
                    }
                });
            });
        </script>
        
        <script>
            $(document).on('click','.callnumber',function(){
                alert($(this).parent().parent().prev().children().text());
            });
        </script>

        <!--[if lte IE 9]><script src="js/placeholders.min.js"></script><![endif]-->
    </body>
</html>